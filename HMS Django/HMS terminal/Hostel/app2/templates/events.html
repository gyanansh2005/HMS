{% extends 'base.html' %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HostelConnect | Events</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .event-badge {
      font-size: 0.75rem;
      padding: 0.3em 0.6em;
    }
    .fade-in {
      animation: fadeIn 0.6s ease-in-out;
    }
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
  </style>
</head>
<body>

<!-- Hero Section (Featured Event) -->
{% if featured_event %}
<div class="bg-light text-dark p-4 rounded text-center mb-4 shadow fade-in">
  <h4>ğŸŒŸ Featured Organizer: {{ featured_event.organizer|default:"Organizer Unknown" }}</h4>
  <p>{{ featured_event.date }} | {{ featured_event.venue }}</p>
  <button class="btn btn-dark btn-sm" data-bs-toggle="modal"
          data-bs-target="#detailsModalFeatured">ğŸ“– View Details</button>
</div>

<!-- Modal for Featured Event -->
<div class="modal fade" id="detailsModalFeatured" tabindex="-1"
     aria-labelledby="detailsModalFeaturedLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="detailsModalFeaturedLabel">{{ featured_event.organizer|default:"Organizer Unknown" }} - Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p><strong>ğŸ‰ Event Name:</strong> {{ featured_event.name }}</p>
        <p><strong>Date:</strong> {{ featured_event.date }}</p>
        <p><strong>Time:</strong> {{ featured_event.time }}</p>
        <p><strong>Venue:</strong> {{ featured_event.venue }}</p>
        <p><strong>Description:</strong><br> {{ featured_event.description|default:"No description provided." }}</p>
        <p><strong>ğŸ“© Contact:</strong> organizer@email.com</p>
        <button class="btn btn-outline-success btn-sm mt-2">ğŸ“† Add to Calendar</button>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
{% endif %}

<div class="container mt-5 fade-in">
  <h2 class="text-center mb-4">ğŸ“… HostelConnect Events</h2>

  <!-- Search -->
  <div class="mb-4">
    <input type="text" class="form-control" id="searchInput" placeholder="ğŸ” Search events by organizer..." onkeyup="searchEvents()">
  </div>

  <!-- Upcoming Events -->
  <div class="mb-5">
    <h4 class="mb-3">ğŸŸ¢ Upcoming Events</h4>
    <div class="row" id="upcomingEventsContainer">
      {% for event in upcoming_events %}
      <div class="col-md-4 mb-4 event-card">
        <div class="card h-100 border-success shadow-sm">
          <div class="card-body">
            <h5 class="card-title">{{ event.organizer|default:"Organizer Unknown" }}</h5>
            <span class="badge bg-info event-badge">Upcoming</span>
            <p class="card-text mt-2">
              <strong>ğŸ‰ Event Name:</strong> {{ event.name }}<br>
              <strong>ğŸ“… Date:</strong> {{ event.date }}<br>
              <strong>â° Time:</strong> {{ event.time }}<br>
              <strong>ğŸ“ Venue:</strong> {{ event.venue }}
            </p>
            <a href="#" class="btn btn-outline-primary btn-sm" data-bs-toggle="modal"
               data-bs-target="#detailsModal{{ event.id }}">ğŸ“– View Details</a>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="detailsModal{{ event.id }}" tabindex="-1"
           aria-labelledby="detailsModalLabel{{ event.id }}" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="detailsModalLabel{{ event.id }}">{{ event.organizer|default:"Organizer Unknown" }} - Details</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <p><strong>ğŸ‰ Event Name:</strong> {{ event.name }}</p>
              <p><strong>Date:</strong> {{ event.date }}</p>
              <p><strong>Time:</strong> {{ event.time }}</p>
              <p><strong>Venue:</strong> {{ event.venue }}</p>
              <p><strong>Description:</strong><br> {{ event.description|default:"No description provided." }}</p>
              <p><strong>ğŸ“© Contact:</strong> organizer@email.com</p>
              <button class="btn btn-outline-success btn-sm mt-2">ğŸ“† Add to Calendar</button>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <p class="text-muted">No upcoming events at the moment.</p>
      {% endfor %}
    </div>
  </div>

  <!-- Past Events -->
  <div>
    <h4 class="mb-3">ğŸ”µ Event History</h4>
    <div class="row" id="pastEventsContainer">
      {% for event in past_events %}
      <div class="col-md-4 mb-4 event-card">
        <div class="card h-100 border-secondary shadow-sm bg-light">
          <div class="card-body">
            <h5 class="card-title">{{ event.organizer|default:"Organizer Unknown" }}</h5>
            <span class="badge bg-secondary event-badge">Past</span>
            <p class="card-text mt-2">
              <strong>ğŸ‰ Event Name:</strong> {{ event.name }}<br>
              <strong>Date:</strong> {{ event.date }}<br>
              <strong>Time:</strong> {{ event.time }}<br>
              <strong>Venue:</strong> {{ event.venue }}
            </p>
            <a href="#" class="btn btn-outline-dark btn-sm" data-bs-toggle="modal"
               data-bs-target="#detailsModalPast{{ event.id }}">ğŸ“– View Details</a>
          </div>
        </div>
      </div>

      <!-- Modal for Past Event -->
      <div class="modal fade" id="detailsModalPast{{ event.id }}" tabindex="-1"
           aria-labelledby="detailsModalPastLabel{{ event.id }}" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="detailsModalPastLabel{{ event.id }}">{{ event.organizer|default:"Organizer Unknown" }} - Details</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <p><strong>ğŸ‰ Event Name:</strong> {{ event.name }}</p>
              <p><strong>Date:</strong> {{ event.date }}</p>
              <p><strong>Time:</strong> {{ event.time }}</p>
              <p><strong>Venue:</strong> {{ event.venue }}</p>
              <p><strong>Description:</strong><br> {{ event.description|default:"No description provided." }}</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <p class="text-muted">No past events to show yet.</p>
      {% endfor %}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  function searchEvents() {
    const input = document.getElementById('searchInput').value.toLowerCase();
    const cards = document.querySelectorAll('.event-card');
    cards.forEach(card => {
      const title = card.querySelector('.card-title').innerText.toLowerCase();
      card.style.display = title.includes(input) ? 'block' : 'none';
    });
  }
</script>
</body>
</html>
{% endblock %}
